<!DOCTYPE html>
<html>
<head th:replace="fragments/header :: header (datatables = true)" />
<body class="top-navigation">
	<div id="wrapper">
		<div id="page-wrapper" class="gray-bg">
			<div th:replace="fragments/topbar :: topbar (page = 'selfservice.index')" />

			<div class="wrapper wrapper-content">
				<div class="row">
					<div class="col-lg-9">
						<div class="ibox">
							<div class="ibox-title">
								<h5><em class="fa fa-user"></em> &nbsp; Erhvervsidentitet</h5>
							</div>

							<div class="ibox-content">
								<form>
									<div class="form-group row">
										<label class="col-sm-2 col-form-label">Navn</label>
										<div class="col-sm-10">
											<input type="text" class="form-control" disabled="disabled" th:value="${form.alias}"/>
										</div>
									</div>
									
									<div class="hr-line-dashed"></div>
									
									<div class="form-group row">
										<label class="col-sm-2 col-form-label">Bruger-ID</label>
										<div class="col-sm-10">
											<input type="text" class="form-control" disabled="disabled" th:value="${form.userId}"/>
										</div>
									</div>

									<div class="hr-line-dashed"></div>

									<div class="form-group row">
										<label class="col-sm-2 col-form-label">Tilknyttet AD konto</label>
										<div class="col-sm-10">
											<input type="text" class="form-control" disabled="disabled" th:value="${form.samAccountName}"/>
										</div>
									</div>

									<div class="hr-line-dashed"></div>
									
									<div class="form-group row">
										<label class="col-sm-2 col-form-label">
											Status
											<th:block th:if="${form.status == T(dk.digitalidentity.mvc.selfservice.dto.SelfServiceStatus).BLOCKED}">
												<em class="fa fa-lg fa-exclamation-circle pull-right text-danger" data-html="true" data-toggle="popover" data-trigger="hover" data-placement="top" th:data-content="#{__${form.statusMessage}__}" aria-hidden="true"></em>
											</th:block>
										</label>
										<div class="col-sm-10">
											<input type="text" class="form-control" disabled="disabled" th:value="#{__${form.status.message}__}"/>
										</div>
									</div>

									<div class="hr-line-dashed"></div>

									<div class="form-group row">
										<label class="col-sm-2 col-form-label">Sikringsniveau</label>
										<div class="col-sm-10">
											<input type="text" class="form-control" disabled="disabled" th:value="#{__${form.nsisLevel.message}__}"/>
										</div>
									</div>

									<div class="hr-line-dashed"></div>

									<div class="form-group row">
										<label class="col-sm-2 col-form-label">E-mail</label>
										<div class="col-sm-10">
											<input type="text" class="form-control" disabled="disabled" th:value="${form.email}"/>
										</div>
									</div>

								</form>
							</div>
						</div>
					</div>
					
					<div th:replace="fragments/rightbar :: selfservice (page = 'selfservice.index')" />
					
					<div class="col-lg-12">
						<div class="ibox ">
							<div class="ibox-title">
								<h5><em class="fa fa-mobile"></em> &nbsp; MFA Klienter</h5>
							</div>

							<div id="mfa-devices-holder" class="ibox-content">
								<div style="text-align: center; padding-top: 20px; padding-bottom: 20px;">
									<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
								</div>
							</div>
						</div>
					</div>
					
					<div class="col-lg-12">
						<div class="ibox ">
							<div class="ibox-title">
								<h5><em class="fa fa-bars"></em> &nbsp; Hændelseslog</h5>
							</div>

							<div class="ibox-content">

								<div class="table-responsive">
									<table id="eventlog" class="table table-striped table-bordered table-hover" >
										<thead>
											<tr>
												<th style="width: 180px;">Tidspunkt</th>
												<th>Hændelse</th>
											</tr>
										</thead>
	
					                    <tbody>
					                    </tbody>
				                    </table>
		                        </div>
                            </div>
                        </div>
                    </div>
	            </div>
	        </div>

			<div th:replace="fragments/footer :: footer" />
		</div>
	</div>

	<div th:replace="fragments/footer :: scripts (datatables = true)" />
	
	<script th:inline="javascript">
		/*<![CDATA[*/
		
		/*[+
		var flashMessage = [[${flashMessage}]];
		+]*/

		var token = $("meta[name='_csrf']").attr("content");

        $(document).ready(function() {
            $('#eventlog').DataTable({
            	"destroy": true,
				"ajax": {
					"contentType": "application/json",
					"url": "/rest/selvbetjening/eventlog",
					"type": "POST",
					"headers": {
						"X-CSRF-TOKEN": token
					},
					"data": function(d) {
					 	return JSON.stringify(d);
					}
				},
				"serverSide": true,
				"columns": [
					{
						"data": "tts",
						"className": "text-nowrap",
						"render": function (data, type, row, meta) {
							return data.substring(0, 10) + '&nbsp;&nbsp;' + data.substring(11, 19);
						}
					},
					{
						"data": "message",
						"orderable": false
					}
				],
		        "order": [ [ 0, "desc" ] ],
				"ordering":  true,
				"pageLength": 10,
                "bSort": false,
                "dom": "<'row'<'col-sm-12'tr>><'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
                "responsive": true,
		        "language": {
		            "info":         "Viser _START_ til _END_ af _TOTAL_ hændelser",
		            "zeroRecords":  "Ingen data...",
		            "infoEmpty":    "Ingen data...",
		            "paginate": {
		                "previous": "Forrige",
		                "next": "Næste"
		            }
		        }
            });
            
            $('#mfa-devices-holder').load('/selvbetjening/fragment/mfa-devices', function() {
	            $('#mfa-devices').DataTable({
	                "pageLength": 10,
	                "bSort": false,
	                "dom": "<'row'<'col-sm-12'tr>><'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
	                "responsive": true,
			        "language": {
			            "info":         "Viser _START_ til _END_ af _TOTAL_ klienter",
			            "zeroRecords":  "Ingen klienter...",
			            "infoEmpty":    "Ingen klienter...",
			            "paginate": {
			                "previous": "Forrige",
			                "next": "Næste"
			            }
			        }
	            });
            });

			if (flashMessage != undefined) {
				toastr.success(flashMessage);
			}
        });

        /*]]>*/
   	</script>
</body>
</html>
